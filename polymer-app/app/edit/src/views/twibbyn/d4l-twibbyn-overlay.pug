link(rel="import", href="/bower_components/polymer/polymer.html")

link(rel="import", href="/src/d4l-logging/d4l-logging.html")
link(rel="import", href="/src/d4l-card/d4l-card-behaviors.html")

link(rel="import", href="/src/d4l-theme.html")
link(rel="import", href="/src/d4l-icons.html")
link(rel="import", href="/src/shared-styles.html")

dom-module#d4l-twibbyn-overlay
  style(is="custom-style" include="iron-flex iron-positioning iron-flex-alignment")
  style(include="d4l-theme")
  style(include="shared-styles")
  style(include="shared-card-styles").
    :host {
      display: block;
    }
    .twibbyn-wrapper {
      position: relative;
    }
    .twibbyn-wrapper > img.overlay {
      position: absolute;
      top: 0px;
      left: 0px;
    }
    .twibbyn-wrapper > img {
      max-width: 100%;
      min-width: 100%;
    }

  template
    .twibbyn-wrapper
      img.overlay(hidden$="[[!__hasTwibbyn]]", src="[[__twibbynImage]]")
      img(src="[[image]]")

  script.
    Polymer({
      is: 'd4l-twibbyn-overlay',
      behaviors: [
        Polymer.D4LLogging
      ],
      properties: {
        logLevel: {
          type: Number,
          value: 3
        },
        image: {
          type: String
        },
        twibbyn:{
          type: String,
          value: null
        },
        __hasTwibbyn: {
          type: Boolean,
          notify: true,
          computed: '__computeHasTwibbyn(twibbyn)'
        },
        __twibbynEndpoint: {
          type: String,
          value: 'http://cdn.forlabour.com/'
        },
        __twibbynImage: {
          type: String,
          computed: '__computeTwibbynImage(twibbyn)'
        }
      },

      __computeTwibbynImage: function(twibbyn){
        if (!twibbyn) {
          return null;
        }

        return `${this.get('__twibbynEndpoint')}${twibbyn}`;
      },

      __computeHasTwibbyn: function(twibbyn) {
        return (twibbyn);
      }
    });
